# ClamAV configuration for DebianForge
# Server-optimized antivirus settings

# Daemon configuration
LogFile /var/log/clamav/clamd.log
LogFileMaxSize 2M
LogTime yes
LogVerbose yes
LogSyslog yes

# Database settings
DatabaseDirectory /var/lib/clamav
DatabaseOwner clamav
DatabaseOwnerReadOnly clamav

# Scan settings
MaxDirectoryRecursion 20
MaxFileSize 100M
MaxScanSize 150M
StreamMaxLength 25M

# Performance settings
MaxThreads 12
ReadTimeout 300
MaxConnectionQueueLength 15
MaxDirectoryRecursion 20

# Security settings
User clamav
AllowSupplementaryGroups yes
FixStaleSocket yes
LocalSocket /var/run/clamav/clamd.ctl
LocalSocketMode 666

# On-access scanning (optional, can be enabled per directory)
#OnAccessPrevention yes
#OnAccessExtraScanning yes

# Exclude patterns
ExcludePath ^/proc/
ExcludePath ^/sys/
ExcludePath ^/dev/
ExcludePath ^/tmp/
ExcludePath ^/var/tmp/
ExcludePath ^/var/cache/
ExcludePath ^/var/log/
ExcludePath ^/var/run/

# Include patterns for important directories
IncludePath /home/
IncludePath /var/www/
IncludePath /etc/
IncludePath /usr/local/

# Notification settings
LogFileMaxSize 2M
LogRotate yes
LogVerbose yes
