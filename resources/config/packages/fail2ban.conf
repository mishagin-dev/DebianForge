# Fail2ban configuration for DebianForge
# Server-optimized intrusion prevention settings

[DEFAULT]
# Ban time and find time
bantime = 3600
findtime = 600
maxretry = 3

# Ban action
banaction = iptables-multiport
banaction_allports = iptables-allports

# Logging
loglevel = INFO
logtarget = /var/log/fail2ban.log

# Database
dbfile = /var/lib/fail2ban/fail2ban.sqlite3

# Socket
socket = /var/run/fail2ban/fail2ban.sock

# PID file
pidfile = /var/run/fail2ban/fail2ban.pid

# Jail settings
ignoreip = 127.0.0.1/8 ::1
ignorecommand =
bantime = 3600
findtime = 600
maxretry = 3
backend = auto
usedns = warn

# SSH jail
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

# HTTP jail (for web servers)
[http-get-dos]
enabled = true
port = http,https
filter = http-get-dos
logpath = /var/log/apache2/access.log
maxretry = 300
findtime = 300
bantime = 600

# FTP jail
[vsftpd]
enabled = true
port = ftp,ftp-data,ftps,ftps-data
filter = vsftpd
logpath = /var/log/vsftpd.log
maxretry = 3
bantime = 3600
findtime = 600

# Mail jail
[postfix]
enabled = true
port = smtp,465,submission
filter = postfix
logpath = /var/log/mail.log
maxretry = 3
bantime = 3600
findtime = 600

# Database jail
[mysql]
enabled = true
port = 3306
filter = mysql
logpath = /var/log/mysql/error.log
maxretry = 3
bantime = 3600
findtime = 600
